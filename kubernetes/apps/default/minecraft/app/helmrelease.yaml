---
apiVersion: helm.toolkit.fluxcd.io/v2beta1
kind: HelmRelease
metadata:
  name: java-tf
  namespace: default
spec:
  interval: 15m
  chart:
    spec:
      chart: minecraft
      version: 4.7.4
      sourceRef:
        kind: HelmRepository
        name: itzg
        namespace: flux-system
  maxHistory: 2
  install:
    createNamespace: true
    remediation:
      retries: 3
  upgrade:
    cleanupOnFail: true
    remediation:
      retries: 3
  uninstall:
    keepHistory: false
  values:
    controller:
      annotations:
        reloader.stakater.com/auto: "true"
    image:
      repository: itzg/minecraft-server
      tag: latest@sha256:3f33564d506cce3fcfcb07ddf42cfe7cbe906c1a53734263014826cec2ad553b
    minecraftServer:
      eula: true
      version: "1.18.2"
      type: "PAPER"
      paperDownloadUrl: https://api.papermc.io/v2/projects/paper/versions/1.18.2/builds/388/downloads/paper-1.18.2-388.jar
      difficulty: normal
      maxWorldSize: 10000
      whitelist: AurumAutomaton,Jinx_The_Crazy,_jakewolf,EbuVitae,DaisyDuck1,JayPKaye,FluxCutie,LegatusFlagrans,ScarletCatto,DawnTheDurr,Taowosol,Brandstellefter,Not_Three_Foxes,MarSparks,CarameltehCat,WarmCynder,Cobalt_cat2,Xkilljoy98,Dryptosaurus
      icon: https://cdn.discordapp.com/attachments/1069418678556307456/1070330176312975470/Untitled_02-01-2023_06-42-57_3.png
      ops: AurumAutomaton,Jinx_The_Crazy,Brandstellefter
      allowNether: true
      announcePlayerAchievements: false
      enableCommandBlock: true
      generateStructures: true
      hardcore: false
      maxBuildHeight: 256
      maxTickTime: 60000
      viewDistance: 10
      spawnProtection: 16
      gameMode: survival
      levelType: DEFAULT
      vanillaTweaksShareCodes: 9CIWkF,gquxh9
      onlineMode: true
      serviceType: LoadBalancer
      servicePort: 62557
      LoadBalancerIP: 10.0.10.122
      rcon:
        enabled: true
        port: 25575
        existingSecret: rcon-password
        secretKey: rcon-password
        serviceType: ClusterIP
    persistence:
      storageClass: nfs
      dataDir:
        enabled: true
        size: 1Gi
    mcBackup:
      enabled: true
      image: itzg/mc-backup
      tag: latest@sha256:3f7c228141995c0abebf8e2b25b85547970401d723bb703b23fde30744aca778
      persistence:
        storageClass: nfs
        backupdir:
          enabled: true
          Size: 1Gi
